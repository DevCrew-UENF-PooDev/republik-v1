<%= stylesheet_link_tag "components/templatee/home_component" %>

<div class="main-content">
  <%= render(Organisms::Header::NavbarComponent.new()) %>
  <section>
    <div class="sidebar">
      <h2>Amigos</h2>
      <div class="sidebar-section">
        <!-- Amigo 1 -->
        <div class="friend">
          <%= image_tag("icons/PerfilImagePlaceHolder.svg", :alt => "Avatar de Rivera Escriva", :class => "avatar") %>
          <div class="friend-info">
            <div class="friend-header">
              <span class="name">Rivera Escriva</span>
              <span class="date">01/09/2024</span>
            </div>
            <p class="status">¬øTermin√≥ el trabalho?</p>
          </div>
          <span class="status-indicator online"></span>
        </div>

        <!-- Amigo 2 -->
        <div class="friend">
          <%= image_tag("icons/PerfilImagePlaceHolder.svg", :alt => "Avatar de Enzo Alberix", :class => "avatar") %>
          <div class="friend-info">
            <div class="friend-header">
              <span class="name">Enzo Alberix</span>
              <span class="date">20/08/2024</span>
            </div>
            <p class="status">Assistiu o √∫ltimo ep de OP?</p>
          </div>
          <span class="status-indicator online"></span>
        </div>
      </div>

      <h2>Comunidades</h2>
      <div class="sidebar-section">
        <% @communities.each do |comunidade| %>
          <div class="community">
            <%= image_tag("icons/ComunidadeImagePerfilPlaceHolder.svg", :alt => "Logo #{comunidade.nome}", :class => "avatar") %>
            <div class="community-info">
              <span class="name"><%= comunidade.nome %></span>
              <p class="last-activity">√öltima atividade h√° <%= time_ago_in_words(comunidade.updated_at) %></p>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Separar depois em Post -->
    <div class="posts-container">
      <% @posts.each do |postagem| %>
        <div class="post-card">
          <!-- Cabe√ßalho -->
          <div class="post-header">
            <%= image_tag("icons/ComunidadeImagePerfilPlaceHolder.svg", :alt => "Icone Comunidade", :class => "community-icon") %>
            <div class="post-info">
              <div class="community-name"><%= postagem.comunidade.try(:nome) || "Sem comunidade" %></div>
              <div class="user-name"><%= postagem.usuario.nome %></div>
            </div>
            <div class="post-options">
              <span class="icon-options">‚ãÆ</span>
            </div>
          </div>

          <!-- Conte√∫do da Postagem -->
          <div class="post-content">
            <h1><%= postagem.titulo %></h1>
            <p><%= postagem.conteudo %></p>
          </div>

          <!-- Rodap√© -->
          <div class="post-footer">
            <div class="post-reactions">
              <button class="reaction-button">üëç Rea√ß√µes</button>
              <button class="comment-button">üí¨ Comentar</button>
            </div>
            <div class="post-stats">
              <span class="views-count">180</span> Rea√ß√µes ‚Ä¢ 
              <span class="comments-count"><%= postagem.comentarios.count %> coment√°rios</span>
            </div>
          </div>

          <!-- Coment√°rios -->
          <div class="post-comments">
            <h4>Coment√°rios:</h4>
            <% postagem.comentarios.each do |comentario| %>
              <div class="comment">
                <strong><%= comentario.usuario.username %>:</strong>
                <p><%= comentario.conteudo %></p>
              </div>
            <% end %>

              <h4>Adicionar um coment√°rio:</h4>
              <%= form_with(model: [postagem, Comentario.new], local: true) do |form| %>
                <div class="form-group">
                  <%= form.label :conteudo, "Seu coment√°rio" %>
                  <%= form.text_area :conteudo, class: "form-control" %>
                </div>
                <div class="form-group">
                  <%= form.submit "Comentar", class: "btn btn-primary" %>
                </div>
              <% end %>
          </div>
        </div>      
      <% end %>
    </div>
  </section>
</div>
